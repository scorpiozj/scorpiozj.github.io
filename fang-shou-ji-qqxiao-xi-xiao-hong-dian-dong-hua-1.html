<!DOCTYPE html>
<html lang="en">
<head>

        <title>仿手机QQ消息小红点动画1</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="http://icocoa.tk/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="http://icocoa.tk/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="http://icocoa.tk/theme/pygment.css" />

        <script src="http://icocoa.tk/theme/js/libs/modernizr-2.6.2.min.js"></script>






</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="http://icocoa.tk/">To be Independent <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="http://icocoa.tk/">Home</a></li>


              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="http://icocoa.tk/fang-shou-ji-qqxiao-xi-xiao-hong-dian-dong-hua-1.html" rel="bookmark"
                   title="Permalink to 仿手机QQ消息小红点动画1">仿手机QQ消息小红点动画1</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2015-05-17T13:00:00+08:00">
                Sun 17 May 2015
              </abbr>
              <address class="vcard author">
                By <a class="url fn" href="http://icocoa.tk/author/charles-zhu.html">Charles Zhu</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>Author: Charles Zhu<br/>
Summary: 动画学习</p>
<h2>前言</h2>
<p>偶然发现iPhone QQ 显示消息条数的小红点可以响应动作事件，也有人问我这样的动画该怎么做，这里就把实现的思路简单的描述一下。在实现的过程中，同样发现该功能并没有看到的那么简单，要做一个完备的动画效果需要有一定的功底。因此，本篇会先侧重于实现思路，并不会实现一个一模一样的效果。<br/>
下面是iPhone QQ小红点的动作交互效果：<br/>
<img alt="iPhoneQQ" src="./imgs/20150517/QQSpring.gif"/></p>
<h2>分析</h2>
<p>首先我们分析拖拽时候的表现：</p>
<ol>
<li>原先的小红点顺着手指移动，并与原来所处位置通过一个小尾巴(即移动的轨迹)连接</li>
<li>与原先位置在一定范围内时，小尾巴出现；超过一定范围时，小尾巴不出现</li>
<li>释放手指，小红点回到原先位置，并有弹簧动画效果</li>
<li>释放手指时离原先位置超过一定范围则不返回原点，而是有消失的泡沫动画</li>
</ol>
<p>抛开细节，抓住要点，我归纳了几个要点：</p>
<ol>
<li>小原点随手指移动</li>
<li>小尾巴分情况出现</li>
<li>手指释放后，小红点弹回原先位置</li>
</ol>
<p>除此之外，红点上的文字，消失等情形的处理不是主要问题，我们先缓一缓。</p>
<h2>实现</h2>
<h3>红点的移动</h3>
<p>首先实现一个圆形的view，并且可以随手指移动。在一定移动范围内，手指离开后，view返回原处并带有弹簧效果；超出范围，view则停留在手指离开处。<br/>
我们通过drawRect:来画一个圆；设置一个CGPoint的对象来记录开始触摸时的位置；接着就是实现相关的touchEvent:。因为都是很基本的内容，直接上代码。</p>
<div class="highlight"><pre><span class="c1">//头文件</span>
<span class="k">@interface</span> <span class="nc">ZZSpringView</span> : <span class="bp">UIView</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">initWithSquareLength:</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nv">length</span> <span class="nf">originPoint:</span><span class="p">(</span><span class="bp">CGPoint</span><span class="p">)</span><span class="nv">oPoint</span><span class="p">;</span>
<span class="k">@end</span>
<span class="c1">//类文件</span>
<span class="k">const</span> <span class="n">CGFloat</span> <span class="n">kOffset</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">;</span><span class="c1">//拖拽的范围限制</span>
<span class="k">@interface</span> <span class="nc">ZZSpringView</span> <span class="p">()</span>
<span class="p">{</span>
    <span class="bp">CGPoint</span> <span class="n">pointOriginCenter</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">ZZSpringView</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">initWithFrame:</span><span class="p">(</span><span class="bp">CGRect</span><span class="p">)</span><span class="nv">frame</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span> <span class="o">=</span> <span class="p">[</span><span class="nb">super</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">frame</span><span class="p">])</span>
    <span class="p">{</span>
        <span class="n">pointOriginCenter</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">center</span><span class="p">;</span>            
        <span class="nb">self</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">initWithSquareLength:</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nv">length</span> <span class="nf">originPoint:</span><span class="p">(</span><span class="bp">CGPoint</span><span class="p">)</span><span class="nv">oPoint</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="n">oPoint</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">oPoint</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">length</span><span class="p">)])</span>
    <span class="p">{</span>

    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Only override drawRect: if you perform custom drawing.</span>
<span class="c1">// An empty implementation adversely affects performance during animation.</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect:</span><span class="p">(</span><span class="bp">CGRect</span><span class="p">)</span><span class="nv">rect</span> <span class="p">{</span>
    <span class="c1">// Drawing code</span>
    <span class="n">CGContextRef</span> <span class="n">context</span> <span class="o">=</span> <span class="n">UIGraphicsGetCurrentContext</span><span class="p">();</span>
    <span class="n">CGContextSetAllowsAntialiasing</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">CGContextSetShouldAntialias</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>

    <span class="n">CGContextAddEllipseInRect</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">rect</span><span class="p">);</span>
    <span class="n">CGContextSetFillColorWithColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">redColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">);</span>
    <span class="n">CGContextFillPath</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">_isDistanceEnough:</span><span class="p">(</span><span class="bp">CGPoint</span><span class="p">)</span><span class="nv">point</span>
<span class="p">{</span>

    <span class="n">CGFloat</span> <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="n">kOffset</span> <span class="o">*</span> <span class="n">kOffset</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//touch event</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">touchesBegan:</span><span class="p">(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">touches</span> <span class="nf">withEvent:</span><span class="p">(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span>
<span class="p">{</span>
    <span class="bp">UITouch</span> <span class="o">*</span><span class="n">touch</span> <span class="o">=</span>  <span class="p">[</span><span class="n">touches</span> <span class="n">anyObject</span><span class="p">];</span>
    <span class="n">pointOriginCenter</span> <span class="o">=</span> <span class="p">[</span><span class="n">touch</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">superview</span><span class="p">];</span>

    <span class="p">[</span><span class="bp">UIView</span> <span class="nl">animateWithDuration</span><span class="p">:</span><span class="mf">.3</span> <span class="nl">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
        <span class="nb">self</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">;</span>
    <span class="p">}];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">touchesCancelled:</span><span class="p">(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">touches</span> <span class="nf">withEvent:</span><span class="p">(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span>
<span class="p">{</span>

<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">touchesMoved:</span><span class="p">(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">touches</span> <span class="nf">withEvent:</span><span class="p">(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span>
<span class="p">{</span>

    <span class="bp">UITouch</span> <span class="o">*</span><span class="n">touch</span> <span class="o">=</span>  <span class="p">[</span><span class="n">touches</span> <span class="n">anyObject</span><span class="p">];</span>
    <span class="bp">CGPoint</span> <span class="n">pointMove</span> <span class="o">=</span> <span class="p">[</span><span class="n">touch</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">superview</span><span class="p">];</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">touchesEnded</span><span class="p">:(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="n">touches</span> <span class="nl">withEvent</span><span class="p">:(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="n">event</span>
<span class="p">{</span>
    <span class="bp">UITouch</span> <span class="o">*</span><span class="n">touch</span> <span class="o">=</span>  <span class="p">[</span><span class="n">touches</span> <span class="n">anyObject</span><span class="p">];</span>
    <span class="bp">CGPoint</span> <span class="n">pointEnd</span> <span class="o">=</span> <span class="p">[</span><span class="n">touch</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">superview</span><span class="p">];</span>
    <span class="n">CGFloat</span> <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">([</span><span class="nb">self</span> <span class="nl">_isDistanceEnough</span><span class="p">:</span><span class="n">pointEnd</span><span class="p">])</span>
    <span class="p">{</span>
        <span class="c1">//may be destory self animation</span>
        <span class="nb">self</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">pointEnd</span><span class="p">;</span>
        <span class="n">pointOriginCenter</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">center</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="bp">UIView</span> <span class="nl">animateWithDuration</span><span class="p">:</span><span class="mf">1.0</span>
                              <span class="nl">delay</span><span class="p">:</span><span class="mf">.0</span>
             <span class="nl">usingSpringWithDamping</span><span class="p">:</span><span class="mf">0.1</span>
              <span class="nl">initialSpringVelocity</span><span class="p">:</span><span class="mf">.0</span>
                            <span class="nl">options</span><span class="p">:</span><span class="mi">0</span>
                         <span class="nl">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
            <span class="nb">self</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">;</span>
        <span class="p">}</span>
                         <span class="nl">completion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>

        <span class="p">}];</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>在touchBegin事件中，因为点击小红点的位置与中心会有偏移，通过UIView animation做一个平滑的过度。而在touchEnd事件中，返回弹簧震荡的效果是使用UIView的Spring animation。</p>
<h3>添加小尾巴(轨迹)</h3>
<p>我画了一张简化的模拟拖拽过程的图：<br/>
<img alt="Drag" src="./imgs/20150517/Drag.png"/></p>
<p>虚线圆是view原来的位置，P0是其圆点；实线圆是移动的位置，P1是圆点。设置两圆的切线（红色），把封闭的部分都填充为同一个颜色的话，就能大致模拟出相似的效果。这里隐含了几个前提：</p>
<ol>
<li>实际的轨迹是带有弧度的曲线，这里使用了切线来代替（红色的切线）</li>
<li>拖拽的时候，原先位置的圆形view会随拖拽距离变小，这里设置为一个固定大小的圆（半径为原来的一半）</li>
</ol>
<p>鉴于此，我们需要求出的是两对切点的位置，使之成为一个封闭图形进行填充。同时，虚线位置的小圆也进行填充。这样，就基本完成类似的功能。<br/>
首先我们需要扩展当前context的范围，为了简便，通过添加尾巴的子view来实线，这样可以利用原先的红点view。现在我们已知P0，P1，以及各自的半径，然后求外围矩形的位置和长度。因为可以按任意方向拖拽，按当前的计算方式，需要分四种情况讨论。按笛卡尔坐标系的划分，图例是第一象限的情形。同理还有二三四的可能。为了迅速验证方案的可行性，这里只对第一象限进行讨论和模拟。<br/>
定义新view：</p>
<div class="highlight"><pre><span class="k">typedef</span> <span class="k">enum</span> <span class="o">:</span> <span class="n">NSUInteger</span> <span class="p">{</span>
    <span class="n">ZZLineDirection1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="c1">//northease</span>
    <span class="n">ZZLineDirection2</span><span class="p">,</span><span class="c1">//northwest</span>
    <span class="n">ZZLineDirection3</span><span class="p">,</span><span class="c1">//southwest</span>
    <span class="n">ZZLineDirection4</span><span class="c1">//southeast</span>
<span class="p">}</span> <span class="n">ZZLineDirection</span><span class="p">;</span>

<span class="k">@interface</span> <span class="nc">ZZSpringTailView</span> : <span class="bp">UIView</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">assign</span><span class="p">)</span> <span class="n">ZZLineDirection</span> <span class="n">lineDirection</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">assign</span><span class="p">)</span> <span class="n">CGFloat</span> <span class="n">radius</span><span class="p">;</span><span class="c1">//centerradius</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">assign</span><span class="p">)</span> <span class="n">CGFloat</span> <span class="n">moveRadius</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
<p>ZZLineDirection代表的是某象限，radius是P0的半径，moveRadius为P1半径。
我们在touchMove事件中添加一个view，在此之前，我们会在ZZSpringView中添加一个ZZSpringTailView实例，用于内部访问。touchMove的实现更新为：</p>
<div class="highlight"><pre><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">touchesMoved:</span><span class="p">(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">touches</span> <span class="nf">withEvent:</span><span class="p">(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span>
<span class="p">{</span>

    <span class="bp">UITouch</span> <span class="o">*</span><span class="n">touch</span> <span class="o">=</span>  <span class="p">[</span><span class="n">touches</span> <span class="n">anyObject</span><span class="p">];</span>
    <span class="bp">CGPoint</span> <span class="n">pointMove</span> <span class="o">=</span> <span class="p">[</span><span class="n">touch</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">superview</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">([</span><span class="nb">self</span> <span class="nl">_isDistanceEnough</span><span class="p">:</span><span class="n">pointMove</span><span class="p">])</span>
    <span class="p">{</span>
        <span class="c1">//beyond the offset, hide the view</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tailView</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">tailView</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">//redraw the view</span>
        <span class="nb">self</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tailView</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">tailView</span> <span class="o">=</span> <span class="p">[[</span><span class="n">ZZSpringTailView</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
            <span class="p">[</span><span class="nb">self</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">tailView</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">CGFloat</span> <span class="n">widthHalf</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">/</span><span class="mf">2.0</span><span class="p">;</span>

        <span class="n">CGFloat</span> <span class="n">minX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//= MIN(pointMove.x, pointOriginCenter.x);</span>
        <span class="n">CGFloat</span> <span class="n">minY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//= MIN(pointMove.y, pointOriginCenter.y);</span>
        <span class="n">CGFloat</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">widthHalf</span><span class="p">;</span>


        <span class="c1">//the width: the distance betweent two points and the origin size's width/2</span>
        <span class="bp">CGRect</span> <span class="n">frameInSuper</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span> <span class="n">minY</span><span class="p">,</span> <span class="n">fabsf</span><span class="p">(</span><span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>  <span class="o">+</span> <span class="n">widthHalf</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">fabsf</span><span class="p">(</span><span class="n">pointMove</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>  <span class="o">+</span> <span class="n">widthHalf</span> <span class="o">+</span> <span class="n">radius</span><span class="p">);</span>

        <span class="n">tailView</span><span class="p">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">tailView</span><span class="p">.</span><span class="n">moveRadius</span> <span class="o">=</span> <span class="n">radius</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"direnction1"</span><span class="p">);</span>
            <span class="n">tailView</span><span class="p">.</span><span class="n">lineDirection</span> <span class="o">=</span> <span class="n">ZZLineDirection1</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">radius</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">radius</span><span class="p">;</span>

        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"direnction2"</span><span class="p">);</span>
            <span class="n">tailView</span><span class="p">.</span><span class="n">lineDirection</span> <span class="o">=</span> <span class="n">ZZLineDirection2</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"direnction3"</span><span class="p">);</span>
            <span class="n">tailView</span><span class="p">.</span><span class="n">lineDirection</span> <span class="o">=</span> <span class="n">ZZLineDirection3</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pointMove</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">radius</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"direnction4"</span><span class="p">);</span>
            <span class="n">tailView</span><span class="p">.</span><span class="n">lineDirection</span> <span class="o">=</span> <span class="n">ZZLineDirection4</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">radius</span><span class="p">;</span>
            <span class="n">frameInSuper</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pointOriginCenter</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">radius</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">tailView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">convertRect</span><span class="p">:</span><span class="n">frameInSuper</span> <span class="nl">fromView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">superview</span><span class="p">];</span>
        <span class="p">[</span><span class="n">tailView</span> <span class="n">setNeedsDisplay</span><span class="p">];</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
<p>这里的实现是把tailview添加到springview之上，通常情况下，clipToBouds默认是NO的，因此这种添加超出父view bound 的子view方案是可行的。需要注意的是，上述的两个point是在spring view的父view内的，因此，在最后确定tailView frame的时候需要转换到springView的坐标系。<br/>
接下来就是tailView的drawRect实现。这里主要需要做2件事情：</p>
<ol>
<li>绘制P0为圆心的圆</li>
<li>绘制2对切点构成的封闭图形</li>
</ol>
<p>drawRect的部分实现：</p>
<div class="highlight"><pre><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect:</span><span class="p">(</span><span class="bp">CGRect</span><span class="p">)</span><span class="nv">rect</span>
<span class="p">{</span>

    <span class="n">CGContextRef</span> <span class="n">context</span> <span class="o">=</span> <span class="n">UIGraphicsGetCurrentContext</span><span class="p">();</span>
    <span class="n">CGContextSetAllowsAntialiasing</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">CGContextSetShouldAntialias</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>

    <span class="n">CGContextSetStrokeColorWithColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">greenColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">);</span>
    <span class="n">CGContextSetFillColorWithColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">redColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">);</span>
    <span class="n">CGContextSetLineWidth</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="bp">CGPoint</span> <span class="n">pointStart</span><span class="p">,</span> <span class="n">pointEnd</span><span class="p">;</span><span class="c1">//center</span>

    <span class="bp">CGPoint</span> <span class="n">movePoint1</span><span class="p">,</span> <span class="n">movePoint2</span><span class="p">;</span><span class="c1">//移动圆的2个切点</span>
    <span class="bp">CGPoint</span> <span class="n">centerPoint1</span><span class="p">,</span> <span class="n">centerPoint2</span><span class="p">;</span><span class="c1">//原有圆的2个切点</span>
    <span class="n">CGFloat</span> <span class="n">moveRadius</span> <span class="o">=</span> <span class="n">_moveRadius</span><span class="p">;</span><span class="c1">//移动圆 弧的半径</span>

    <span class="n">CGFloat</span> <span class="n">sinval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">csinval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">CGFloat</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">_lineDirection</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nl">ZZLineDirection1</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="n">pointStart</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">moveRadius</span><span class="p">,</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">moveRadius</span><span class="p">);</span>
            <span class="n">pointEnd</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span> <span class="o">+</span> <span class="n">_radius</span><span class="p">,</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">_radius</span><span class="p">);</span>

            <span class="n">distance</span> <span class="o">=</span> <span class="n">CGRectGetHeight</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="o">*</span> <span class="n">CGRectGetHeight</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="o">+</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="o">*</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="n">rect</span><span class="p">);</span>

            <span class="n">sinval</span> <span class="o">=</span> <span class="n">CGRectGetHeight</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="o">*</span> <span class="n">CGRectGetHeight</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span><span class="o">/</span><span class="n">distance</span><span class="p">;</span>
            <span class="n">csinval</span> <span class="o">=</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="o">*</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span><span class="o">/</span><span class="n">distance</span><span class="p">;</span>



            <span class="n">movePoint2</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">pointStart</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">moveRadius</span> <span class="o">*</span> <span class="n">sinval</span><span class="p">,</span> <span class="n">pointStart</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">moveRadius</span><span class="o">*</span><span class="n">csinval</span><span class="p">);</span>
            <span class="n">movePoint1</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">pointStart</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">moveRadius</span><span class="o">*</span><span class="n">sinval</span><span class="p">,</span> <span class="n">pointStart</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">moveRadius</span><span class="o">*</span><span class="n">csinval</span><span class="p">);</span>

            <span class="n">centerPoint2</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">_radius</span><span class="o">*</span><span class="n">sinval</span><span class="p">,</span> <span class="n">pointEnd</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">_radius</span><span class="o">*</span><span class="n">csinval</span><span class="p">);</span>
            <span class="n">centerPoint1</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">pointEnd</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">_radius</span> <span class="o">*</span> <span class="n">sinval</span><span class="p">,</span> <span class="n">pointEnd</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">_radius</span><span class="o">*</span><span class="n">csinval</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="nl">ZZLineDirection2</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="nl">ZZLineDirection3</span><span class="p">:</span>
        <span class="p">{</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="nl">ZZLineDirection4</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="n">CGContextMoveToPoint</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">movePoint1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">movePoint1</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="n">CGContextAddLineToPoint</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">movePoint2</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">movePoint2</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="n">CGContextAddLineToPoint</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">centerPoint1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">centerPoint1</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="n">CGContextAddLineToPoint</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">centerPoint2</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">centerPoint2</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="n">CGContextClosePath</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

    <span class="n">CGContextFillPath</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
    <span class="n">CGContextStrokePath</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>


    <span class="n">CGContextAddArc</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">pointEnd</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pointEnd</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">_radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">CGContextFillPath</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
<p>计算过程就不详细描述了，初中数学的知识就够了。接着运行下，看看效果。  </p>
<p><img alt="SpringDemo3" src="./imgs/20150517/QQSpring3.gif"/></p>
<p>从运行效果看，还是差强人意的。这显示了方案的可行性。<br/>
那么相应二三四象限的情况也能做类似的处理，这里就不贴代码了。  </p>
<p>由于时间的关系，暂时研究到此，下一篇会把功能逐步完善。主要会包含添加文字的情形等内容，敬请期待。<br/>
如果有更好的实现方式，也请大家赐教！</p>
            </div><!-- /.entry-content -->
            
            <!-- Neighbor -->
            <div class="pagination">
      <ul>
        <li class="prev"><a href="http://icocoa.tk/sui-gan.html">← Previous : 随感</a></li>
        
        <li class="next"><a href="http://icocoa.tk/fang-shou-ji-qqxiao-xi-xiao-hong-dian-dong-hua-2.html">仿手机QQ消息小红点动画2:Next →</a></li>
      </ul>
    </div>



            




        </div><!-- /.eleven.columns -->
        
        

<div class="three columns">

<h4>Pages</h4>

 <ul>
  </ul>

<h4>Categories</h4>
<ul>
		<li><a href="http://icocoa.tk/category/design.html">Design</a></li>
		<li><a href="http://icocoa.tk/category/ios.html">iOS</a></li>
		<li><a href="http://icocoa.tk/category/iostips.html">[iOSTips]</a></li>
		<li><a href="http://icocoa.tk/category/linux.html">Linux</a></li>
		<li><a href="http://icocoa.tk/category/python.html">Python</a></li>
		<li><a href="http://icocoa.tk/category/sui-gan.html">随感</a></li>
		<li><a href="http://icocoa.tk/category/swiftstudy.html">SwiftStudy</a></li>
		<li><a href="http://icocoa.tk/category/version.html">Version</a></li>
		<li><a href="http://icocoa.tk/category/voip.html">VOIP</a></li>
</ul>


<h4>Tags</h4>
	<ul>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/ce-shi.html">测试</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/storyboard.html">storyboard</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/pelican.html">pelican</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/svn.html">svn</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/objc.html">objc</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/launch-screen.html">launch screen</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/localized.html">Localized</a></li>
	    <li class="tag-1"><a href="http://icocoa.tk/tag/ios8.html">ios8</a></li>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/uiscrollview.html">UIScrollView</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/quartzcomposer.html">QuartzComposer</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/mvc.html">mvc</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/git.html">git</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/python.html">python</a></li>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/mvvm.html">MVVM</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/wwdc-2014.html">wwdc 2014</a></li>
	    <li class="tag-0"><a href="http://icocoa.tk/tag/ios.html">iOS</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/eclipse.html">eclipse</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/security.html">security</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/pjsip.html">pjsip</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/distribution.html">distribution</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/appextension.html">AppExtension</a></li>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/sketch.html">sketch</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/framework.html">framework</a></li>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/.html"></a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/sigsegv.html">sigsegv</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/revert.html">revert</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/autolayout.html">Autolayout</a></li>
	    <li class="tag-3"><a href="http://icocoa.tk/tag/quartzcore.html">quartzcore</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/linux.html">linux</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/appium.html">appium</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/jdk.html">jdk</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/ux.html">ux</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/pattern.html">pattern</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/ui.html">ui</a></li>
	    <li class="tag-2"><a href="http://icocoa.tk/tag/swift.html">swift</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/zong-jie-ji-hua.html">总结 计划</a></li>
	    <li class="tag-4"><a href="http://icocoa.tk/tag/design.html">design</a></li>
</ul>


<nav class="widget">
  <h4>Social</h4>
  <ul>
    <li><a href="https://github.com/scorpiozj">scorpiozj</a></li>
    <li><a href="https://twitter.com/charleszhu_">charleszhu_</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="http://icocoa.tk/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="http://icocoa.tk/theme/js/libs/gumby.min.js"></script>
  <script src="http://icocoa.tk/theme/js/plugins.js"></script>
</body>
</html>